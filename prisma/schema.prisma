generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/**
 * USER
 * - One user can have many trips
 * - Auth handled by Supabase, but we still store user record
 */
model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String?
  createdAt DateTime @default(now())

  trips Trip[]
}

/**
 * TRIP
 * - Core entity of Travel Buddy
 * - AI output stored as JSON
 * - Editable & regeneratable
 */
model Trip {
  id String @id @default(uuid())

  // ðŸ”‘ Relation (optional for anonymous trips)
  userId String?
  user   User?   @relation(fields: [userId], references: [id])

  status TripStatus @default(DRAFT)

  destination String
  startDate   DateTime
  endDate     DateTime
  travelers   String
  budgetRange String?
  pace        String?
  interests   Json?
  mustVisit   Json?

  itinerary Json

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
}

/**
 * TRIP STATUS
 */
enum TripStatus {
  DRAFT
  SAVED
}
